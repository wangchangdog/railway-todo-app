問題
現在の実装では各操作を行うとき、都度画面遷移が発生しています。
各画面遷移のうち、編集時はシームレスな操作性を実現するため、編集画面をモーダル化することにしました。

また、アクセシビリティの観点から以下を考慮した実装を行うことにしました。

モーダル表示した際のキーボード操作によるフォーカス移動では、モーダル上に配置された要素のみをフォーカス可能とし、フォーカスがモーダル外に移らないようにする。
モーダルを表示している時、キーボードの Esc キー押下でモーダルを閉じる。
簡易に実装可能なライブラリを用いることも可能ですが、モーダル開閉時の HTML 要素上での挙動や実装上考慮されている点については、
Chrome の DevTools 上などでも実際の挙動を確認し、理解しておきましょう。

確認テスト
リスト編集画面をモーダル表示に変更する。
　- 一つ前のページに戻る「Back」のリンク、「Cancel」ボタンは、モーダルを閉じる挙動に変更しましょう。
　- Delete、Update ボタンでは、処理が正常に成功した際、モーダルを閉じる挙動に変更しましょう。
タスク編集画面をモーダル表示に変更する。
　- 一つ前のページに戻る「Back」のリンク、「Cancel」ボタンは、モーダルを閉じる挙動に変更しましょう。
　- Delete、Update ボタンでは、処理が正常に成功した際、モーダルを閉じる挙動に変更しましょう。
モーダルが表示されている時のキーボードによるフォーカス移動では、モーダル上の要素以外にフォーカスが移らないように制御する。
モーダルを表示している時に Esc キー押下でモーダルを閉じるように制御する。

# APIは以下を使用する

https://app.swaggerhub.com/apis-docs/INFO_3/TODOApplication/1.0.0#/

---

# 仕様書: モーダル化による編集画面の実装

## 1. 概要
本仕様書は、リスト編集画面とタスク編集画面をモーダル表示に変更する機能の実装について定義します。

## 2. 機能要件

### 2.1 モーダル表示対象画面
- リスト編集画面
- タスク編集画面

### 2.2 モーダル表示時の挙動
- 既存の画面遷移を廃止し、モーダルダイアログとして表示
- モーダル表示中は背景画面を半透明でオーバーレイ表示
- モーダル外部をクリックしてもモーダルは閉じない（誤操作防止）

### 2.3 モーダル閉じる操作
以下の操作でモーダルを閉じる：
- 「Back」リンクのクリック
- 「Cancel」ボタンのクリック
- 「Delete」ボタンによる削除処理の正常完了後
- 「Update」ボタンによる更新処理の正常完了後
- Escキーの押下

### 2.4 アクセシビリティ要件
- **フォーカストラップ**: モーダル表示中はフォーカスがモーダル内の要素のみに制限される
- **キーボード操作**: Escキーでモーダルを閉じる機能
- **ARIA属性**: 適切なaria-modal、aria-labelledby、aria-describedbyの設定

## 3. 技術仕様

### 3.1 コンポーネント設計
```
Modal.jsx - 汎用モーダルコンポーネント
├── ModalOverlay.jsx - 背景オーバーレイ
├── ModalContent.jsx - モーダル内容エリア
└── ModalHeader.jsx - モーダルヘッダー（閉じるボタン含む）
```

### 3.2 必要な機能
- **フォーカストラップ**: Tab、Shift+Tabキーでのフォーカス移動制御
- **キーボードイベント**: Escキーの検出と処理
- **状態管理**: モーダルの開閉状態をReduxで管理
- **アニメーション**: フェードイン・フェードアウト効果（optional）

### 3.3 実装対象ファイル
```
src/components/Modal.jsx (新規作成)
src/components/Modal.css (新規作成)
src/pages/lists/[listId]/edit/index.page.jsx (修正)
src/pages/lists/[listId]/tasks/[taskId]/edit/index.page.jsx (修正)
src/store/modalSlice.js (新規作成)
```

## 4. 実装手順

### 4.1 Phase 1: 基本モーダルコンポーネント作成
1. Modal.jsxの基本実装
2. ModalOverlay、ModalContent、ModalHeaderの実装
3. 基本的なCSS styling

### 4.2 Phase 2: フォーカストラップ機能実装
1. フォーカス可能要素の検出
2. Tab/Shift+Tabキーでのフォーカス循環制御
3. モーダル表示時の初期フォーカス設定

### 4.3 Phase 3: キーボード操作対応
1. Escキーイベントの監視
2. モーダル閉じる処理の実装

### 4.4 Phase 4: 既存画面のモーダル化
1. リスト編集画面のモーダル化
2. タスク編集画面のモーダル化
3. 既存のルーティングからモーダル表示への変更

### 4.5 Phase 5: 状態管理とイベント処理
1. Redux storeでのモーダル状態管理
2. 各ボタンのイベントハンドラー修正
3. API処理完了後のモーダル閉じる処理

## 5. アクセシビリティ仕様

### 5.1 ARIA属性
- `aria-modal="true"`: モーダルダイアログであることを示す
- `aria-labelledby`: モーダルのタイトルを参照
- `aria-describedby`: モーダルの説明を参照（必要に応じて）
- `role="dialog"`: ダイアログロールの明示

### 5.2 フォーカス管理
- モーダル表示時: 最初のフォーカス可能要素にフォーカス
- Tab移動: モーダル内の要素のみを循環
- モーダル閉じる時: 元のフォーカス位置に復帰

### 5.3 キーボード操作
- `Escape`: モーダルを閉じる
- `Tab`: 次の要素にフォーカス
- `Shift+Tab`: 前の要素にフォーカス

## 6. テスト仕様

### 6.1 単体テスト
- Modal コンポーネントのレンダリング
- フォーカストラップ機能
- キーボードイベント処理
- 状態管理（Redux）

### 6.2 統合テスト
- リスト編集画面のモーダル表示
- タスク編集画面のモーダル表示
- API処理完了後のモーダル閉じる動作

### 6.3 E2Eテスト (Playwright)
- キーボード操作による一連の操作
- アクセシビリティ要件の検証
- 実際のユーザー操作シナリオ

## 7. パフォーマンス考慮事項
- モーダルコンポーネントの条件付きレンダリング
- フォーカストラップのイベントリスナーの適切な削除
- メモリリークの防止

## 8. 成果物
- 実装したコンポーネントファイル
- テストファイル
- 動作確認用のスクリーンショット
- アクセシビリティ検証結果

## 9. 完了基準
- [ ] リスト編集画面がモーダル表示される
- [ ] タスク編集画面がモーダル表示される
- [ ] フォーカストラップが正常に動作する
- [ ] Escキーでモーダルが閉じる
- [ ] 各ボタンでモーダルが適切に閉じる
- [ ] 全テストが成功する
- [ ] アクセシビリティ要件を満たす
- [ ] lint, prettier, typecheck, test, build, playwrightが全て成功する